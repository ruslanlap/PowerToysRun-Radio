#!/bin/bash

# Перевірка, чи є незакомічені зміни
if ! git status --porcelain | grep -q '^'; then
    echo "Незакомічених змін немає."
else
    echo "Помилка: є незакомічені зміни. Закомітьте їх перед продовженням."
    exit 1
fi

# Перевірка, чи є незапушені коміти (припускаємо, що основна гілка - main; замініть на вашу, якщо потрібно)
LOCAL_COMMITS=$(git log --oneline origin/main..HEAD 2>/dev/null | wc -l)
if [ "$LOCAL_COMMITS" -eq 0 ]; then
    echo "Незапушених комітів немає."
else
    echo "Помилка: є $LOCAL_COMMITS незапушених комітів. Запуште їх перед продовженням."
    exit 1
fi

# Видалення локального тагу
echo "Видаляю локальний таг v1.0.0..."
git tag -d v1.0.0

# Видалення віддаленого тагу
echo "Видаляю віддалений таг v1.0.0..."
git push origin :refs/tags/v1.0.0

# Створення нового тагу на поточному коміті
echo "Створюю новий таг v1.0.0..."
git tag v1.0.0

# Пуш нового тагу
echo "Пушу новий таг v1.0.0..."
git push origin v1.0.0

echo "Готово! Таг v1.0.0 видалено і поновому запушено."
